
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estudio matemático de las relaciones entre las dimensiones morfológicas y el peso &#8212; Casos prácticos de Inteligencia Artificial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/01/Coeficientes';</script>
    <link rel="icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Análisis del modelo alométrico longitud-anchura" href="Analisis.html" />
    <link rel="prev" title="Predicción del peso del lenguado a partir de variables morfológicas" href="Peso.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Casos prácticos de Inteligencia Artificial - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Casos prácticos de Inteligencia Artificial - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">FLATCLASS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introduccion.html">FLATfish Length and Thickness CLASification System by Artificial Intelligence</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Peso.html">Predicción del peso del lenguado a partir de variables morfológicas</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Estudio matemático de las relaciones entre las dimensiones morfológicas y el peso</a></li>
<li class="toctree-l2"><a class="reference internal" href="Analisis.html">Análisis del modelo alométrico longitud-anchura</a></li>
<li class="toctree-l2"><a class="reference internal" href="Modelo.html">Algoritmo de inferencia del peso <span class="math notranslate nohighlight">\(W\)</span></a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="Generador.html">Generador datos sintéticos</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Estudio matemático de las relaciones entre las dimensiones morfológicas y el peso</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#justificacion-matematica-y-biologica">Justificación matemática y biológica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-modelos-peso-morfologia">Análisis de modelos peso - morfología</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-potencia-peso-longitud-w-a-cdot-l-b">Modelo potencia peso - longitud: <span class="math notranslate nohighlight">\(W=a\cdot L^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-potencia-peso-superficie-w-a-cdot-s-b">Modelo potencia peso - superficie: <span class="math notranslate nohighlight">\(W=a\cdot S^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-alometrico-longitud-anchura-w-k-cdot-l-a-cdot-a-b">Modelo alométrico Longitud - Anchura: <span class="math notranslate nohighlight">\(W=k \cdot L^a \cdot A^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-potencia-volumetrico-w-a-cdot-c-cdot-v-b">Modelo de potencia volumétrico: <span class="math notranslate nohighlight">\(W=a \cdot (c\cdot V)^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-alometrico-longitud-anchura-altura-w-k-cdot-l-a-cdot-a-b-cdot-h-c">Modelo alométrico Longitud - Anchura - Altura: <span class="math notranslate nohighlight">\(W = k \cdot L^a \cdot A^b \cdot H^c\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparativa-de-modelos-analizados">Comparativa de modelos analizados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="estudio-matematico-de-las-relaciones-entre-las-dimensiones-morfologicas-y-el-peso">
<h1>Estudio matemático de las relaciones entre las dimensiones morfológicas y el peso<a class="headerlink" href="#estudio-matematico-de-las-relaciones-entre-las-dimensiones-morfologicas-y-el-peso" title="Link to this heading">#</a></h1>
<section id="justificacion-matematica-y-biologica">
<h2>Justificación matemática y biológica<a class="headerlink" href="#justificacion-matematica-y-biologica" title="Link to this heading">#</a></h2>
<p>La relación entre la longitud y el peso en peces suele seguir la ley cúbica (<span class="math notranslate nohighlight">\(W\propto L^{3}\)</span>), pero en peces planos como el lenguado, la relación superficie-peso es más adecuada, ya que su cuerpo es achatado y su crecimiento no es isométrico. Los trabajos de [<a class="reference external" href="https://doi.org/10.1111/j.1439-0426.2006.00805.x">Froese, 2006</a>] y <a class="reference external" href="https://doi.org/10.1111/j.1751-5823.2012.00179_26.x">[Haddon et al., 2011]</a> pusieron de manifiesto que en peces planos existe una correlación entre el peso del individuo (<span class="math notranslate nohighlight">\(W\)</span>) y la superficie (<span class="math notranslate nohighlight">\(S\)</span>) del mismo que viene dada por la expresión matemática:</p>
<div class="math notranslate nohighlight" id="equation-eq-peso-superficie">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-peso-superficie" title="Link to this equation">#</a></span>\[W=aS^b\]</div>
<p>en donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span> es un coeficiente empírico que depende de la especie y las condiciones de cultivo.</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> es un exponente que describe la tasa de crecimiento en función de la superficie.</p></li>
</ul>
<p>ya que la altura es menos predictiva que la longitud - anchura (L/A) que sólo contribuye <span class="math notranslate nohighlight">\(\sim5\%\)</span> en modelos morfológicos.</p>
<p>Para obtener valores específicos de ay b, se suelen ajustar datos experimentales usando regresión no lineal minimizando el error cuadrático medio:</p>
<div class="math notranslate nohighlight" id="equation-eq-ecm">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-ecm" title="Link to this equation">#</a></span>\[ECM=\dfrac{1}{N}\sum_{i=1}^N(W_i-aS_i^b)^2\]</div>
<p><a class="reference external" href="https://doi.org/10.1111/j.1095-8649.2011.03223.x">[Torres et al., 2012]</a> recoge que en experimentos realizados con peces planos de las familias Soleidae y Pleuronectidae los coeficientes de la ecuación (1) toman los siguientes valores:</p>
<div class="math notranslate nohighlight">
\[a\approx0,03\quad b\approx1,1-1,4\]</div>
<p>habiendo estimado que en el caso concreto del lenguado estos coeficientes son: <span class="math notranslate nohighlight">\(a=0.024\quad b=1.32\)</span></p>
<p>Los recientes estudios de <a class="reference external" href="https://doi.org/10.21608/ejabf.2023.322449">[El-Bokhty et al., 2023]</a> ponen en entredicho la ecuación (1) y sugieren que el crecimiento alométrico positivo del lenguado común (<em>Solea solea</em>) responde a la variable morfológica de longitud (<span class="math notranslate nohighlight">\(L\)</span>) que se ajusta a la expresión matemática:</p>
<div class="math notranslate nohighlight" id="equation-eq-peso-longitud">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-peso-longitud" title="Link to this equation">#</a></span>\[W=a\cdot L^b\]</div>
<p>Concluyendo, en sus trabajos, que los coeficientes de dicha expresión son:</p>
<div class="math notranslate nohighlight">
\[a\approx0,00029\quad b\approx3,3777\]</div>
<p>Sin embargo, una investigación realizada en las aguas costeras de Pakistán analizó seis especies de peces planos y encontró variaciones significativas en parámetros como la longitud, la anchura y el peso entre las diferentes especies <a class="reference external" href="https://doi.org/10.19080/OFOAJ.2021.14.555884">[W. Ali et al., 2021]</a>.  Aunque este estudio no presentó una fórmula específica que relacione el peso con la longitud y la anchura simultáneamente, sugiere que la anchura es una medida morfológica relevante en la evaluación de las relaciones morfométricas en peces planos. Ambas variables podrían relacionarse mediante la siguiente expresión matemática:</p>
<div class="math notranslate nohighlight" id="equation-eq-peso-longitud-anchura">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-peso-longitud-anchura" title="Link to this equation">#</a></span>\[W=k\cdot L^a \cdot A^b\]</div>
<p>en donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(W\)</span> = peso,</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> = longitud,</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> = anchura,</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> = parámetros específicos por especie</p></li>
</ul>
<p>Por otro lado <a class="reference external" href="https://doi.org/0.1016/j.aqrep.2021.100676">[Freitas et al.,2021]</a> en sus trabajos con <em>Paralichthys olivaceus</em> (falso Halibut del japón) apuntán a que una relación volumétrica es más adecuada si se tiene en cuenta la comprensión dorsoventral. Esta parámetro morfológico actúa como un factor de corrección que hace que el volumen real sea <span class="math notranslate nohighlight">\(\approx70-80\%\)</span> de LxAxH, siendo concretamente de <span class="math notranslate nohighlight">\(0.72\)</span> en el Halibut. Según estos autores el peso de los peces de esta especie se ajustan a la siguiente fórmula:</p>
<div class="math notranslate nohighlight">
\[W=1,05\cdot V^{0,98}\]</div>
<p>que responde a la expresión matemática genérica:</p>
<div class="math notranslate nohighlight" id="equation-eq-peso-volumen">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-peso-volumen" title="Link to this equation">#</a></span>\[W=a\cdot (c\cdot V)^b\]</div>
<p>en donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(W\)</span> = peso,</p></li>
<li><p><span class="math notranslate nohighlight">\(V\)</span> = volumen obtenido como <span class="math notranslate nohighlight">\(L\cdot A \cdot H\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> = longitud,</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> = anchura,</p></li>
<li><p><span class="math notranslate nohighlight">\(H\)</span> = altura,</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> = factor de corrección <span class="math notranslate nohighlight">\(\leq 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> = parámetros específicos por especie</p></li>
</ul>
<p><a class="reference external" href="https://doi.org/0.1007/s12562-019-01287-2">[Lee et al., 2019]</a> usaron un escáner 3D para medir el volumen real en <em>Scophthalmus maximus</em> (Rodaballo) encontrando que el peso de los ejemplares del estudio se ajustan a la expresión:</p>
<div class="math notranslate nohighlight">
\[W=1,12\cdot V-3,25\quad(R^{2}=0,96)\]</div>
</section>
<section id="analisis-de-modelos-peso-morfologia">
<h2>Análisis de modelos peso - morfología<a class="headerlink" href="#analisis-de-modelos-peso-morfologia" title="Link to this heading">#</a></h2>
<p>Se dispone de un dataset <code class="docutils literal notranslate"><span class="pre">Dimensiones_lenguado.xls</span></code> con N=200 registros morfométricos de alevines de lenguado, que incluye medidas de longitud, anchura, altura y peso. Considerando la diversidad de enfoques existentes en la literatura científica, se plantea la evaluación comparativa de distintas expresiones matemáticas que describan la relación entre el peso y las variables morfológicas. En particular, se estudiarán modelos clásicos basados en la relación <span class="math notranslate nohighlight">\(W = a \cdot L^b\)</span>, <span class="math notranslate nohighlight">\(W = a \cdot S^b\)</span> así como formulaciones extendidas que incorporan múltiples dimensiones corporales, como <span class="math notranslate nohighlight">\(W = k \cdot L^a \cdot A^b \cdot H^c\)</span>, con el objetivo de determinar cuál de estas expresiones proporciona un ajuste más preciso a los datos observados. La selección del modelo óptimo se basará en criterios estadísticos de bondad de ajuste y parsimonia, tales como el coeficiente de determinación ajustado (R² ajustado), el error cuadrático medio (RMSE).
Los diferentes modelos de ajuste evaluados fueron ejecutados en un entorno Jupyterlab haciendo uso de librerías python especializadas como: pandas, numpy y scikit-learn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar librerias necesarias</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSS4_COLORS</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-muted&#39;</span><span class="p">)</span>

<span class="c1"># Cargar el dataset</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;./data/Dimensiones_lenguado.xlsx&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Peso (g)</th>
      <th>Longitud (cm)</th>
      <th>Anchura (cm)</th>
      <th>Altura (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.46</td>
      <td>3.3</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.08</td>
      <td>4.5</td>
      <td>1.1</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.67</td>
      <td>3.9</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.98</td>
      <td>4.4</td>
      <td>1.7</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.93</td>
      <td>4.2</td>
      <td>1.8</td>
      <td>0.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos variables comunes</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Longitud (cm)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Anchura (cm)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Altura (cm)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Peso (g)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">H</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="modelo-potencia-peso-longitud-w-a-cdot-l-b">
<h3>Modelo potencia peso - longitud: <span class="math notranslate nohighlight">\(W=a\cdot L^b\)</span><a class="headerlink" href="#modelo-potencia-peso-longitud-w-a-cdot-l-b" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">long_model</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="n">b</span>

<span class="n">params_long</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">long_model</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">params_long</span>
<span class="n">W_pred_long</span> <span class="o">=</span> <span class="n">long_model</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">r2_long</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_long</span><span class="p">)</span>
<span class="n">r2_adj_long</span><span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2_long</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rmse_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_long</span><span class="p">))</span>
<span class="n">mae_long</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_long</span><span class="p">)</span>

<span class="c1"># Visualización ajuste</span>

<span class="c1"># Índices y residuos</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">W_pred_long</span>

<span class="c1"># Crear la figura con 3 subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># === 1. Peso real vs. Peso predicho ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_long</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Línea ideal&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso real&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Real vs. Predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 2. Comparación por índice ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso real&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W_pred_long</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;darkorange&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Índice de muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Peso real vs. predicho por muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 3. Gráfico de residuos ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W_pred_long</span><span class="p">,</span> <span class="n">residuos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;violet&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuo&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Análisis de residuos&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ajustar diseño y mostrar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Resultados del ajuste</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modelo ajustado: W = </span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> · L^</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² = </span><span class="si">{</span><span class="n">r2_long</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE = </span><span class="si">{</span><span class="n">mae_long</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RSME = </span><span class="si">{</span><span class="n">rmse_long</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R²adj = </span><span class="si">{</span><span class="n">r2_adj_long</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cb6bddd7edee6d5933b3959fd761ad924027aad1d9e11274c72c2b0102ddb0ab.png" src="../../_images/cb6bddd7edee6d5933b3959fd761ad924027aad1d9e11274c72c2b0102ddb0ab.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo ajustado: W = 0.00933 · L^3.13480
R² = 0.9433
MAE = 0.5246 g
RSME = 0.8638 g
R²adj = 0.9430 g
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-potencia-peso-superficie-w-a-cdot-s-b">
<h3>Modelo potencia peso - superficie: <span class="math notranslate nohighlight">\(W=a\cdot S^b\)</span><a class="headerlink" href="#modelo-potencia-peso-superficie-w-a-cdot-s-b" title="Link to this heading">#</a></h3>
<p>Para un ajuste óptimo de este modelo hay que tener en cuenta que la morfología aplanada y asimétrica de los lenguados.</p>
<p>Dado que el lenguado es más ancho que alto y tiene una doerma similar a un disco aplanado, podemos usar la fórmula del área de una elipse como aproximación:</p>
<div class="math notranslate nohighlight">
\[S=\dfrac{\pi \cdot L \cdot A}{4}\]</div>
<p>Si tenemos en cuenta que el lenguado no es una elipse perfecta y que la superficie dorsal suele ser más curva de la ventral tendremos que aplicar un factor de corrección cuyo valor varía según la especie [<a class="reference external" href="https://www.researchgate.net/publication/255641396_A_Note_on_The_Examination_of_Morphometric_Differentiation_Among_Fish_Populations_The_Truss_System">Turan C., 1999</a>; <a class="reference external" href="https://doi.org/10.5370/JEET.2013.8.5.1194">Jeong et al., 2013</a>] y que en el caso del lenguado puede estimarse <span class="math notranslate nohighlight">\(\approx 75-90 \%\)</span> del área de la elipse definida por su longitud y anchura.</p>
<p>Este enfoque matemático sólo es aplicable si, como es este caso, el dataset no contiene un valor de superficie real obtenido mediante funciones de procesado de imagen que permita la segmentación precisa del contorno corporal del lenguado y el cálculo de su superficie proyectada mediante herramientas como <code class="docutils literal notranslate"><span class="pre">cv2.contourArea()</span></code>de OpenCV.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Si el dataset contiene datos de superficie real:</span>
<span class="c1"># S = df[&#39;Superficie (cm2)&#39;].values</span>

<span class="c1"># Si el dataset no contiene datos de superficie real:</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">L</span> <span class="o">*</span> <span class="n">A</span>
<span class="n">coef</span> <span class="o">=</span> <span class="mf">0.75</span>

<span class="k">def</span><span class="w"> </span><span class="nf">potencia_model</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c1"># Si hay datos de superficie real obtenidos por procesado de imagen entonces:</span>
    <span class="c1"># superficie_real = S</span>
    <span class="n">superficie_real</span> <span class="o">=</span> <span class="n">coef</span> <span class="o">*</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">S</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">superficie_real</span><span class="p">)</span><span class="o">**</span><span class="n">b</span>

<span class="n">params_pow</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">potencia_model</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">params_pow</span>
<span class="n">W_pred_pow</span> <span class="o">=</span> <span class="n">potencia_model</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">r2_pow</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_pow</span><span class="p">)</span>
<span class="n">r2_adj_pow</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2_pow</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rmse_pow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_pow</span><span class="p">))</span>
<span class="n">mae_pow</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_pow</span><span class="p">)</span>

<span class="c1"># Visualización ajuste</span>

<span class="c1"># Índices y residuos</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">W_pred_pow</span>

<span class="c1"># Crear la figura con 3 subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># === 1. Peso real vs. Peso predicho ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_pow</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Línea ideal&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso real&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Real vs. Predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 2. Comparación por índice ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso real&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W_pred_pow</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;darkorange&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Índice de muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Peso real vs. predicho por muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 3. Gráfico de residuos ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W_pred_pow</span><span class="p">,</span> <span class="n">residuos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;violet&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuo&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Análisis de residuos&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ajustar diseño y mostrar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Resultados del ajuste</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modelo ajustado: W = </span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> · S_real^</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;S_real: </span><span class="si">{</span><span class="n">coef</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> · </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> · S/4&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² = </span><span class="si">{</span><span class="n">r2_pow</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE = </span><span class="si">{</span><span class="n">mae_pow</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RSME = </span><span class="si">{</span><span class="n">rmse_pow</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² adj = </span><span class="si">{</span><span class="n">r2_adj_pow</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5f25a1d63662117fa78b77f943ec5fa91e2107837f95eaefc0cf9d4cdee8e9f0.png" src="../../_images/5f25a1d63662117fa78b77f943ec5fa91e2107837f95eaefc0cf9d4cdee8e9f0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo ajustado: W = 0.13360 · S_real^1.43623
S_real: 0.750 · 3.14159 · S/4
R² = 0.9733
MAE = 0.3734 g
RSME = 0.5925 g
R² adj = 0.9732 g
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-alometrico-longitud-anchura-w-k-cdot-l-a-cdot-a-b">
<h3>Modelo alométrico Longitud - Anchura: <span class="math notranslate nohighlight">\(W=k \cdot L^a \cdot A^b\)</span><a class="headerlink" href="#modelo-alometrico-longitud-anchura-w-k-cdot-l-a-cdot-a-b" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alometric_LA_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">L</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">X</span>
    <span class="k">return</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="n">b</span><span class="p">)</span>

<span class="n">params_la</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">alometric_LA_model</span><span class="p">,</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">A</span><span class="p">),</span> <span class="n">W</span><span class="p">)</span>
<span class="n">k</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">params_la</span>
<span class="n">W_pred_la</span> <span class="o">=</span> <span class="n">alometric_LA_model</span><span class="p">((</span><span class="n">L</span><span class="p">,</span> <span class="n">A</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">r2_la</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_la</span><span class="p">)</span>
<span class="n">r2_adj_la</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2_la</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rmse_la</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_la</span><span class="p">))</span>
<span class="n">mae_la</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_la</span><span class="p">)</span>

<span class="c1"># Índices y residuos</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">W_pred_la</span>

<span class="c1"># Crear la figura con 3 subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="c1"># === 1. Peso real vs. Peso predicho ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_la</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Línea ideal&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso real&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Real vs. Predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 2. Comparación por índice ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso real&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W_pred_la</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;darkorange&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Índice de muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Peso real vs. predicho por muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 3. Gráfico de residuos ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W_pred_la</span><span class="p">,</span> <span class="n">residuos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;violet&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuo&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Análisis de residuos&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ajustar diseño y mostrar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Resultados del ajuste</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modelo ajustado: W = </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">·L^</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">·A^</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² = </span><span class="si">{</span><span class="n">r2_la</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE = </span><span class="si">{</span><span class="n">mae_la</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RSME = </span><span class="si">{</span><span class="n">rmse_la</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² adj = </span><span class="si">{</span><span class="n">r2_adj_la</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4f3feed32f4f9c3a96b2fe237d9539f40c754e3344e10dc8686b13811a53a088.png" src="../../_images/4f3feed32f4f9c3a96b2fe237d9539f40c754e3344e10dc8686b13811a53a088.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo ajustado: W = 0.04891·L^1.644·A^1.272
R² = 0.9739
MAE = 0.3735 g
RSME = 0.5854 g
R² adj = 0.9737 g
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-de-potencia-volumetrico-w-a-cdot-c-cdot-v-b">
<h3>Modelo de potencia volumétrico: <span class="math notranslate nohighlight">\(W=a \cdot (c\cdot V)^b\)</span><a class="headerlink" href="#modelo-de-potencia-volumetrico-w-a-cdot-c-cdot-v-b" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Factor de compresión dorsoventral</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.72</span>

<span class="k">def</span><span class="w"> </span><span class="nf">volumen_model</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="n">b</span>

<span class="n">params_vol</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">volumen_model</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">params_vol</span>
<span class="n">W_pred_vol</span> <span class="o">=</span> <span class="n">volumen_model</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="o">*</span><span class="n">params_vol</span><span class="p">)</span>
<span class="n">r2_vol</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_vol</span><span class="p">)</span>
<span class="n">r2_adj_vol</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2_vol</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rmse_vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_vol</span><span class="p">))</span>
<span class="n">mae_vol</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_vol</span><span class="p">)</span>

<span class="c1"># Visualización ajuste</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">W_pred_vol</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># === 1. Peso real vs. Peso predicho ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_vol</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Línea ideal&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso real (W)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Real vs. Predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 2. Comparación por índice ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso real&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W_pred_vol</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;darkorange&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Índice de muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Peso real vs. predicho por muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 3. Gráfico de residuos ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W_pred_vol</span><span class="p">,</span> <span class="n">residuos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;violet&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuo&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Análisis de residuos&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Resultados del ajuste</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modelo ajustado: W = </span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> · (</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">V)^</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² = </span><span class="si">{</span><span class="n">r2_vol</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE = </span><span class="si">{</span><span class="n">mae_vol</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RSME = </span><span class="si">{</span><span class="n">rmse_vol</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² adj = </span><span class="si">{</span><span class="n">r2_adj_vol</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a40017273f8a92c4151b965fa1da1f98571bc092764e2ce082cd5c2632b48ebc.png" src="../../_images/a40017273f8a92c4151b965fa1da1f98571bc092764e2ce082cd5c2632b48ebc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo ajustado: W = 0.75546 · (0.720V)^0.95762
R² = 0.9746
MAE = 0.4241 g
RSME = 0.5785 g
R² adj = 0.9744 g
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-alometrico-longitud-anchura-altura-w-k-cdot-l-a-cdot-a-b-cdot-h-c">
<h3>Modelo alométrico Longitud - Anchura - Altura: <span class="math notranslate nohighlight">\(W = k \cdot L^a \cdot A^b \cdot H^c\)</span><a class="headerlink" href="#modelo-alometrico-longitud-anchura-altura-w-k-cdot-l-a-cdot-a-b-cdot-h-c" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">alometric_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">L</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">X</span>
    <span class="k">return</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">H</span><span class="o">**</span><span class="n">c</span><span class="p">)</span>

<span class="n">params_nl</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">alometric_model</span><span class="p">,</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">H</span><span class="p">),</span> <span class="n">W</span><span class="p">)</span>
<span class="n">k</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">params_nl</span>
<span class="n">W_pred_nl</span> <span class="o">=</span> <span class="n">alometric_model</span><span class="p">((</span><span class="n">L</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">H</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">r2_nl</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_nl</span><span class="p">)</span>
<span class="n">r2_adj_nl</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2_nl</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rmse_nl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_nl</span><span class="p">))</span>
<span class="n">mae_nl</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_nl</span><span class="p">)</span>

<span class="c1"># Índices de los datos</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">W_pred_nl</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># === 1. Peso real vs. Peso predicho ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">W_pred_nl</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">W</span><span class="p">)],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Línea ideal&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso real (W)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho (W_pred_nl)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Real vs. Predicho&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 2. Comparación por índice ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso real&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">W_pred_nl</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;darkorange&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Peso predicho&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Índice de muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Peso real vs. predicho por muestra&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === 3. Gráfico de residuos ===</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">W_pred_nl</span><span class="p">,</span> <span class="n">residuos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">CSS4_COLORS</span><span class="p">[</span><span class="s1">&#39;violet&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Peso predicho (W_pred_nl)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Residuo (W - W_pred_nl)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Análisis de residuos&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Resultados del ajuste</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Modelo ajustado: W = </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">· L^</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> · A^</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">· H^</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² = </span><span class="si">{</span><span class="n">r2_nl</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE = </span><span class="si">{</span><span class="n">mae_nl</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RSME = </span><span class="si">{</span><span class="n">rmse_nl</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R² adj = </span><span class="si">{</span><span class="n">r2_adj_nl</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> g&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3d02778837af56f34c34d804b10eff316ffb60c2f8ec6ff70d994eb6e62c0ed2.png" src="../../_images/3d02778837af56f34c34d804b10eff316ffb60c2f8ec6ff70d994eb6e62c0ed2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo ajustado: W = 0.17609· L^1.24336 · A^1.16881· H^0.49480
R² = 0.9833
MAE = 0.3237 g
RSME = 0.4681 g
R² adj = 0.9831 g
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="comparativa-de-modelos-analizados">
<h2>Comparativa de modelos analizados<a class="headerlink" href="#comparativa-de-modelos-analizados" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelos</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Longitud&#39;</span><span class="p">,</span> <span class="s1">&#39;Superficie&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitud-Anchura&#39;</span><span class="p">,</span> <span class="s1">&#39;Volumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitud-Anchura-Altura&#39;</span><span class="p">]</span>
<span class="n">r2</span> <span class="o">=</span> <span class="p">[</span><span class="n">r2_long</span><span class="p">,</span> <span class="n">r2_pow</span><span class="p">,</span> <span class="n">r2_la</span><span class="p">,</span> <span class="n">r2_vol</span><span class="p">,</span> <span class="n">r2_nl</span><span class="p">]</span>
<span class="n">r2_adj</span> <span class="o">=</span> <span class="p">[</span><span class="n">r2_adj_long</span><span class="p">,</span> <span class="n">r2_adj_pow</span><span class="p">,</span> <span class="n">r2_adj_la</span><span class="p">,</span> <span class="n">r2_adj_vol</span><span class="p">,</span> <span class="n">r2_adj_nl</span><span class="p">]</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="p">[</span><span class="n">rmse_long</span><span class="p">,</span> <span class="n">rmse_pow</span><span class="p">,</span> <span class="n">rmse_la</span><span class="p">,</span> <span class="n">rmse_vol</span><span class="p">,</span> <span class="n">rmse_nl</span><span class="p">]</span>
<span class="n">mae</span> <span class="o">=</span> <span class="p">[</span><span class="n">mae_long</span><span class="p">,</span> <span class="n">mae_pow</span><span class="p">,</span> <span class="n">mae_la</span><span class="p">,</span> <span class="n">mae_vol</span><span class="p">,</span> <span class="n">mae_nl</span><span class="p">]</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo Peso vs.&#39;</span><span class="p">:</span> <span class="n">modelos</span><span class="p">,</span>
    <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
    <span class="s1">&#39;R² ajustado&#39;</span><span class="p">:</span> <span class="n">r2_adj</span><span class="p">,</span>
    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
    <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span>
<span class="p">})</span>
<span class="n">results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo Peso vs.</th>
      <th>R²</th>
      <th>R² ajustado</th>
      <th>RMSE</th>
      <th>MAE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Longitud</td>
      <td>0.943280</td>
      <td>0.943006</td>
      <td>0.863761</td>
      <td>0.524589</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Superficie</td>
      <td>0.973307</td>
      <td>0.973178</td>
      <td>0.592544</td>
      <td>0.373385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Longitud-Anchura</td>
      <td>0.973946</td>
      <td>0.973693</td>
      <td>0.585408</td>
      <td>0.373508</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Volumen</td>
      <td>0.974558</td>
      <td>0.974435</td>
      <td>0.578497</td>
      <td>0.424128</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Longitud-Anchura-Altura</td>
      <td>0.983343</td>
      <td>0.983099</td>
      <td>0.468080</td>
      <td>0.323711</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="conclusiones">
<h2>Conclusiones<a class="headerlink" href="#conclusiones" title="Link to this heading">#</a></h2>
<p>El análisis comparativo de los cinco modelos lineales desarrollados para predecir el peso de alevines de <em>Solea solea</em> revela que la adición progresiva de variables morfológicas incrementa el poder explicativo desde un <span class="math notranslate nohighlight">\(R^{2}\)</span> de <span class="math notranslate nohighlight">\(0,94\)</span>, obtenido con la longitud como único predictor, hasta un <span class="math notranslate nohighlight">\(0,98\)</span> cuando se incorporan longitud, anchura y altura. Esta mejora se traduce en una reducción del error cuadrático medio (RMSE) de <span class="math notranslate nohighlight">\(0,86\,g\)</span> a <span class="math notranslate nohighlight">\(0,47\,g\)</span> y del error absoluto medio (MAE) de <span class="math notranslate nohighlight">\(0,52\,g\)</span> a <span class="math notranslate nohighlight">\(0,32\,g\)</span>. No obstante, la ganancia marginal entre los modelos basados en superficie (longitud × anchura) y los que incluyen altura o volumen apenas alcanza <span class="math notranslate nohighlight">\(0,11–0,12\,g\)</span> en RMSE, lo que sugiere rendimientos decrecientes al introducir la tercera dimensión. Dado que la altura exige una adquisición estereoscópica o reconstrucción volumétrica costosa y propensa a errores, mientras que longitud y anchura se obtienen con alta precisión mediante sistemas de visión artificial 2‑D, el modelo de superficie emerge como la opción óptima para estimaciones en línea de la biomasa durante el grading industrial.</p>
<p>Sin embargo, los coeficientes de ajuste fueron calculados sobre el conjunto completo de 209 individuos sin partición de entrenamiento y prueba ni validación cruzada, lo que introduce un sesgo optimista difícil de cuantificar. Además, la ausencia de diagnósticos de normalidad de residuos y de colinealidad entre predictores cuestiona la solidez estadística de los modelos multivariantes y aconseja la aplicación de transformaciones alométricas y técnicas de regularización antes de su despliegue. Bajo un escenario operativo en el que los límites de talla están separados varias veces el MAE (~0,37 g para el modelo de superficie), el error residual estimado parece compatible con la precisión requerida; con todo, resulta imprescindible fijar umbrales de aceptabilidad. En síntesis, la modelización basada en longitud y anchura proporciona una estimación robusta y operacionalmente viable del peso de <em>S. solea</em>, mientras que la inclusión de la altura ofrece beneficios estadísticos marginales que no compensan la complejidad práctica añadida sin una validación rigurosa que confirme su ventaja.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Peso.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Predicción del peso del lenguado a partir de variables morfológicas</p>
      </div>
    </a>
    <a class="right-next"
       href="Analisis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Análisis del modelo alométrico longitud-anchura</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#justificacion-matematica-y-biologica">Justificación matemática y biológica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-modelos-peso-morfologia">Análisis de modelos peso - morfología</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-potencia-peso-longitud-w-a-cdot-l-b">Modelo potencia peso - longitud: <span class="math notranslate nohighlight">\(W=a\cdot L^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-potencia-peso-superficie-w-a-cdot-s-b">Modelo potencia peso - superficie: <span class="math notranslate nohighlight">\(W=a\cdot S^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-alometrico-longitud-anchura-w-k-cdot-l-a-cdot-a-b">Modelo alométrico Longitud - Anchura: <span class="math notranslate nohighlight">\(W=k \cdot L^a \cdot A^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-potencia-volumetrico-w-a-cdot-c-cdot-v-b">Modelo de potencia volumétrico: <span class="math notranslate nohighlight">\(W=a \cdot (c\cdot V)^b\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-alometrico-longitud-anchura-altura-w-k-cdot-l-a-cdot-a-b-cdot-h-c">Modelo alométrico Longitud - Anchura - Altura: <span class="math notranslate nohighlight">\(W = k \cdot L^a \cdot A^b \cdot H^c\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparativa-de-modelos-analizados">Comparativa de modelos analizados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Javier Álvarez Osuna
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Feeding Systems S.L. - GNU General Public License 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>